# Certo Spec
# Format: TOML

[spec]
name = "certo"
version = 1
created = 2026-02-05T14:07:00Z
author = "metaist"

# =============================================================================
# CLAIMS - Verifiable statements about certo
# =============================================================================

[[claims]]
id = "c-e50e9d4"
text = "Spec files use TOML format"
status = "confirmed"
source = "human"
author = "metaist"
level = "block"
tags = ["format"]
created = 2026-02-05T14:07:00Z
why = "TOML is explicit, has no implicit type coercion, no code execution risk"
considered = ["YAML", "JSON", "KDL", "Markdown+frontmatter"]

[[claims.checks]]
kind = "shell"
cmd = "test -f .certo/spec.toml && head -1 .certo/spec.toml"
matches = ["# Certo Spec"]

[[claims]]
id = "c-caf8ac4"
text = "Certo stores its data in .certo/ directory"
status = "confirmed"
source = "human"
author = "metaist"
level = "block"
tags = ["structure"]
created = 2026-02-05T14:07:00Z
why = "Dotted because it's tool-managed, like .git"
considered = ["Single file", "certo/ (not dotted)", "certo.toml at root"]

[[claims.checks]]
kind = "shell"
cmd = "test -d .certo"

[[claims]]
id = "c-b0d1e6d"
text = "All timestamps in spec files use UTC with timezone"
status = "confirmed"
source = "human"
author = "metaist"
level = "warn"
tags = ["format"]
created = 2026-02-05T14:45:00Z
why = "TOML natively supports datetime with timezone. UTC avoids ambiguity."
considered = ["Local dates only", "Unix timestamps"]

# No check yet - would need to verify all datetime fields end in Z

[[claims]]
id = "c-08f4b1f"
text = "certo check --offline completes in under 2 seconds"
status = "confirmed"
source = "human"
author = "metaist"
level = "skip"
tags = ["performance"]
created = 2026-02-05T14:50:00Z
why = "Developers run checks frequently. Slow checks get disabled or ignored."

# Skipped: self-referential check causes recursion. See #21 for --skip flag.
[[claims.checks]]
kind = "shell"
cmd = "bash -c 'time certo check --offline 2>&1' | grep -E '^real' | grep -E '0m[01]'"

[[claims]]
id = "c-e52fcc2"
text = "Knowledge base is bundled with certo package"
status = "confirmed"
source = "human"
author = "metaist"
level = "block"
tags = ["architecture"]
created = 2026-02-05T17:00:00Z
why = "We don't know enough about what kinds of knowledge we need yet. Bundling avoids premature schema design."
considered = ["Fetchable to ~/.certo/", "Separate certo-knowledge package"]

[[claims.checks]]
kind = "shell"
cmd = "test -d src/certo/kb/python"

[[claims]]
id = "c-14d95c9"
text = "Knowledge metadata uses TOML format (meta.toml)"
status = "confirmed"
source = "human"
author = "metaist"
level = "warn"
tags = ["format"]
created = 2026-02-05T17:00:00Z
why = "TOML is already our standard"
considered = ["JSON", "YAML"]

[[claims.checks]]
kind = "shell"
cmd = "test -f src/certo/kb/python/typeshed/meta.toml"

[[claims]]
id = "c-b5b9a45"
text = "Python stdlib version data comes from typeshed VERSIONS file"
status = "confirmed"
source = "human"
author = "metaist"
level = "block"
tags = ["knowledge"]
created = 2026-02-05T17:00:00Z
why = "Typeshed is already used by pyright, mypy. The VERSIONS file is exactly what we need."
considered = ["Scrape Python docs", "Maintain our own database"]

[[claims.checks]]
kind = "shell"
cmd = "test -f src/certo/kb/python/typeshed/VERSIONS"

[[claims]]
id = "c-32260b0"
text = "certo kb update fetches knowledge from authoritative sources"
status = "confirmed"
source = "human"
author = "metaist"
level = "warn"
tags = ["transparency"]
created = 2026-02-05T17:00:00Z
why = "Transparency aligns with certo's philosophy. Anyone can audit or reproduce."
considered = ["Hidden scripts", "Manual curation"]

[[claims.checks]]
kind = "shell"
cmd = "grep -q 'github.com/python/typeshed' src/certo/kb/update.py"

[[claims]]
id = "c-14b5f9e"
text = "Claims can use LLM verification via OpenRouter API"
status = "confirmed"
source = "human"
author = "metaist"
level = "warn"
tags = ["verification"]
created = 2026-02-05T18:00:00Z
why = "LLMs can handle anything expressible in natural language without upfront work."
considered = ["Static checks only", "Custom code for each check type"]

[[claims.checks]]
kind = "shell"
cmd = "grep -q 'openrouter.ai' src/certo/llm/provider.py"

[[claims]]
id = "c-eb9736a"
text = "Test directory structure mirrors source directory structure"
status = "confirmed"
source = "human"
author = "metaist"
level = "warn"
tags = ["maintainability"]
created = 2026-02-05T19:00:00Z
why = "Mirroring keeps navigation simple"
considered = ["Flat test directory", "Tests alongside source"]

# No check yet - would need to compare directory trees

[[claims]]
id = "c-9f15ff6"
text = "Test coverage is at least 98%"
status = "confirmed"
source = "human"
author = "metaist"
level = "skip"
tags = ["maintainability", "slow"]
created = 2026-02-05T14:07:00Z

# Skipped: runs full test suite, too slow for quick checks. Verified by CI.
[[claims.checks]]
kind = "shell"
cmd = "uv run pytest --cov=src --cov-report=term 2>&1 | grep TOTAL"
matches = ["(100|99|98)%?"]

[[claims]]
id = "c-b72253d"
text = "certo runs on all Python versions in CI matrix"
status = "confirmed"
source = "human"
author = "metaist"
level = "block"
tags = ["compatibility"]
created = 2026-02-05T14:07:00Z

# No check yet - would use scan results

[[claims]]
id = "c-8d6ceb6"
text = "docs/cli.md documents all CLI commands"
status = "confirmed"
source = "human"
author = "metaist"
level = "warn"
tags = ["documentation"]
created = 2026-02-05T14:07:00Z

[[claims.checks]]
kind = "llm"
files = ["docs/cli.md", "src/certo/cli/__init__.py"]

# =============================================================================
# ISSUES - Closed design decisions and open questions
# =============================================================================

[[issues]]
id = "i-b830f79"
text = "What problem does certo solve?"
status = "closed"
tags = ["vision"]
created = 2026-02-05T14:07:00Z
closed_reason = "The verification problem is universalâ€”gap between intent and implementation. AI just made it urgent. Certo addresses both."

[[issues]]
id = "i-b962737"
text = "What kinds of assurance does certo provide?"
status = "closed"
tags = ["vision"]
created = 2026-02-05T14:07:00Z
closed_reason = "Multiple types: confidence, proof, auditability, alerting. Strongest available for each statement, explicit about what kind."

[[issues]]
id = "i-cb56f93"
text = "Who are the target users?"
status = "closed"
tags = ["vision"]
created = 2026-02-05T14:07:00Z
closed_reason = "In order: (1) metaist building certo, (2) metaist on other projects, (3) technical users, (4) non-technical stakeholders."

[[issues]]
id = "i-2016602"
text = "What's the minimal viable loop?"
status = "closed"
tags = ["bootstrap"]
created = 2026-02-05T14:07:00Z
closed_reason = "Parse spec, verify at least one claim. Start with check command, can verify certo with certo immediately."

[[issues]]
id = "i-4fc6f7b"
text = "How should spec content be organized?"
status = "closed"
tags = ["format"]
created = 2026-02-05T14:07:00Z
closed_reason = "Narrow-broad-narrow: top-level categories, items within, details in each. Avoids indentation hell and context loss."

[[issues]]
id = "i-8204e03"
text = "How should context overrides work?"
status = "closed"
tags = ["format"]
created = 2026-02-05T14:45:00Z
closed_reason = "Structured and nested. modifications = [{ claim = 'c-xxx', action = 'relax' }]. Machine-readable, validates cleanly."

[[issues]]
id = "i-cadb84f"
text = "How do we handle implicit assumptions?"
status = "closed"
tags = ["architecture"]
created = 2026-02-05T16:00:00Z
closed_reason = "Track explicitly. certo scan discovers assumptions, check verifies consistency. Enables automated checking."

[[issues]]
id = "i-25434e0"
text = "Which language ecosystems to support?"
status = "closed"
tags = ["scope"]
created = 2026-02-05T17:00:00Z
closed_reason = "Start with Python stdlib, extensible to others. Prove the pattern first, don't over-engineer."

[[issues]]
id = "i-6030f3e"
text = "What types belong in the spec?"
status = "closed"
tags = ["format"]
created = 2026-02-05T20:00:00Z
closed_reason = "Three types: claims (verifiable statements), issues (questions/decisions), contexts (where rules differ). Everything else is metadata."

# =============================================================================
# CONTEXTS
# =============================================================================

[[contexts]]
id = "x-333c04d"
name = "bootstrap"
description = "While building certo with certo; some claims may not be fully verified yet"
created = 2026-02-05T14:07:00Z
expires = 2026-06-01T00:00:00Z
modifications = []
